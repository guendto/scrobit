var z=Object.defineProperty,G=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var L=(e,t,n)=>t in e?z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,x=(e,t)=>{for(var n in t||(t={}))U.call(t,n)&&L(e,n,t[n]);if(R)for(var n of R(t))Z.call(t,n)&&L(e,n,t[n]);return e},T=(e,t)=>G(e,Y(t));import{d as f,a as q,l as m,j as w,r as y,B,b as K}from"./vendor.1073fc1b.js";const W=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}};W();const J="https://api.coingecko.com/api/v3/coins/",Q=({coinId:e,currency:t,from:n,to:a})=>`${J}/${e}/market_chart/range?vs_currency=${t}&from=${n}&to=${a}`,X=async({startDate:e,endDate:t,coinId:n="bitcoin",currency:a="eur"})=>{const r=f(e).unix(),s=f(t).add(1,"hour").unix(),i=Q({coinId:n,currency:a,from:r,to:s});return q.get(i)};var ee={marketChartRange:X};const te=(e,t=null)=>{if(!e||e.length===0)throw new Error("no data");if(!!t&&(!e[t]||e[t].length===0))throw new Error(`key "${t}" missing in data`)};var S={hasData:te};const{TRACE:ge,SILENT:re}=m.levels;m.setLevel(re);const ne=e=>{S.hasData(e,"prices");const t=([h,u],[g,d])=>u>d?[h,u]:[g,d],n=([h,u],[g,d])=>u<d?[h,u]:[g,d],a=e.prices.reduce(t);m.debug("highestPrice",a),m.debug("beep",e.prices[0]);const r=e.prices.findIndex(([h])=>h===a[0]);if(m.debug("highestIndex",r),r<=0)return m.warn("not profitable date range"),{isProfitable:!1};const s=e.prices.slice(0,r);m.debug("adjustedDateRange",s);const i=s.reduce(n);return m.debug("lowestPrice",i),{buy:i,sell:a,isProfitable:!0}},oe=e=>{if(!e.isProfitable)return{error:"This is a non-profitable date range. The price is only falling in this period of time."};const{buy:t,sell:n}=e,[a,r]=t,[s,i]=n;return{buy:`${f(a)} for ${r.toLocaleString()}\u20AC`,sell:`${f(s)} for ${i.toLocaleString()}\u20AC`}};var H={buyLowSellHighRange:ne,toHumanReadableMessage:oe};const se=e=>{S.hasData(e,"total_volumes");const t=([n,a],[r,s])=>a<s?[r,s]:[n,a];return e.total_volumes.reduce(t)};var ae={highestVolume:se};const ie=e=>{S.hasData(e,"prices");let[t,n]=e.prices[0],a=0,r=1;return e.prices.forEach(([s,i],h,u)=>{const g=Object.is(u.length-1,h),d=f(s),v=d.date()===f(t).date();(d.hour()===0||g)&&!v&&(i<=n?r+=1:r=1,r>a&&(a=r)),t=s,n=i}),a};var le={longestBearishDownward:ie};const o=w.exports.jsx,l=w.exports.jsxs,P=w.exports.Fragment;function ce(){const[e,t]=y.exports.useState({startDate:new Date("2021-12-02"),endDate:new Date("2021-12-24")}),[n,a]=y.exports.useState(!1),[r,s]=y.exports.useState({}),i=c=>f(c).format("YYYY-MM-DD"),h=async()=>{try{const{startDate:c,endDate:b}=e,D=await ee.marketChartRange({startDate:c,endDate:b}),{data:p}=D;if(!p.prices||p.prices.length===0)throw new Error("No data, try another date rate");const N=H.buyLowSellHighRange(p),{buy:$,sell:C,isProfitable:E}=N,[_,F]=ae.highestVolume(p),[M,I]=C||[0,0],[O,V]=$||[0,0];s({trend:{longestBearish:le.longestBearishDownward(p)},trading:{highestVolume:F.toLocaleString(),date:i(_)},whenToBuyAndSell:{buy:{price:V.toLocaleString(),date:i(O)},sell:{price:I.toLocaleString(),date:i(M)},isProfitable:E,range:N}}),a(!0)}catch(c){window.alert(c)}},u=()=>l("div",{children:[o("h1",{children:"scrobit"}),o("h2",{children:"Scrooge's bitcoin market analyzer"}),!n&&o("h3",{children:"(the tool to analyze bitcoin market value for the given date range)"})]}),g=({name:c,value:b})=>{t(D=>T(x({},D),{[c]:b}))},d=()=>l(P,{children:["From",o(B,{className:"date-picker",selected:e.startDate,onChange:c=>g({name:"startDate",value:c}),selectsStart:!0,startDate:e.startDate,endDate:e.endDate}),"To",o(B,{className:"date-picker",selected:e.endDate,onChange:c=>g({name:"endDate",value:c}),selectsEnd:!0,startDate:e.startDate,endDate:e.endDate,minDate:e.startDate})]}),v=()=>l("div",{className:"date-range-view",children:[o(d,{}),o("div",{children:o("button",{onClick:()=>h(),className:"button-round",type:"button",children:"Analyze now"})}),l("div",{className:"footer",children:["Market chart history data provided by"," ",o("a",{className:"link",href:"https://coingecko.com",target:"_blank",rel:"noopener noreferrer",children:"CoinGecko"}),"."]})]}),k=()=>l("div",{className:"label-warning",children:["This is a ",o("i",{children:"non-profitable"})," date range. The price is"," ",o("b",{children:"only falling"})," in this period of time."]}),A=()=>{const{range:c}=r.whenToBuyAndSell,b=H.toHumanReadableMessage(c);return l("div",{className:"label-profit",children:[o("b",{children:"Lo and behold"}),", time travel is possible. Buy low and sell high. Simple.",l("ul",{children:[l("li",{children:[o("b",{children:"Buy"})," on ",b.buy]}),l("li",{children:[o("b",{children:"Sell"})," on ",b.sell]})]}),"Now, go make some serious dough."]})},j=()=>o(P,{children:r.whenToBuyAndSell.isProfitable?o(A,{}):o(k,{})});return l("div",{className:"app",children:[l("header",{className:"header",children:[o(u,{}),n?o(()=>l("div",{children:[l("div",{className:"label-trend",children:["The ",o("i",{children:"longest bearish downward trend"})," took"," ",l("b",{children:[r.trend.longestBearish," days"]})," during this period of time."]}),l("div",{className:"label-trading",children:[o("b",{children:r.trading.date})," had the"," ",o("i",{children:"highest trading volume"})," for BTC with total of"," ",l("b",{children:[r.trading.highestVolume.toLocaleString(),"\u20AC"]}),"."]}),o(j,{}),l("div",{children:[o("button",{className:"button-round ",type:"button",onClick:()=>a(!1),children:"Analyze again"}),l("div",{className:"footer",children:["Data processed",l("div",{className:"date-range",children:[i(e.startDate)," -"," ",i(e.endDate)]})]})]})]}),{}):o(v,{})]}),o("a",{className:"github-fork-ribbon",href:"https://github.com/guendto/scrobit","data-ribbon":"Fork me on GitHub",title:"Fork me on GitHub",children:"Fork me on GitHub"})]})}K.exports.render(o(y.exports.StrictMode,{children:o(ce,{})}),document.getElementById("root"));
